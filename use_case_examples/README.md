# Use case examples

We present several use case examples demonstrating the application of YACHT for identifying taxonomy in microbiome studies. Specifically, we focus on three applicable scenarios that include low abundance samples,  metagenome-assembled genome (MAG) fishing, and synthetic metagenomes. With these use case examples, we explore YACHT's flexible parameters, such a *k*-size, ANI, and minimum coverage, demonstrating how modifying these settings can influence and yield valuable insights into the taxonomy of these samples. 

## Case I: Low abundance samples
Metagenomic samples, such as those obtained from skin, can yield low microbial DNA concentrations, which can lead to bias conclusions. YACHT provides users with the flexibility to modify key parameters, such as the ANI threshold and *k*-size, to enhance the detection of difficult-to-identify organisms. Thus, adjusting these parameters can improve reliability in species identification. For example, increasing the ANI threshold restricts species merging in preprocessing, while increasing the *k*-size makes YACHT more stringent when comparing samples to the trained reference. In this use case example, we demonstrate how tuning these parameters influences species reporting. 

We applied YACHT to a randomly selected metagenomic sample, SRR32008482 (Bioproject PRJNA1209946)—a human facial skin sample passed sequenced from whole shotgun sequencing. For the following discussion, we focus our attention to a moderate minimal coverage of 0.05. By varying *k*-sizes (21, 31, and 51) and ANI thresholds (0.90, 0.95, and 0.995), we analyzed how these adjustments impact genome reporting. First, at an ANI threshold of 0.95, we observed that increasing the *k*-size from 21 to 51 resulted in more unique species being reported—rising from 19 species at *k*-size 21 to 115 species at *k*-size 51. Importantly, larger *k*-sizes experience a trade-off in that more exclusive $k$-mers can be identified corresponding to reference genomes, but higher sensitivity to sequencing error and mutations, resulting in few matches to a sample. This can ascertain the "correct" $k$-mer size to use, one can fix all other parameters, start with *k=31* vary the *k*-mer size up and down, and choose the size where the total number of predictions is minimized. 

Consequently, a higher *k*-size would require the sample to have more *k*-mers matching to the genome to confidently report as present. Too high of a *k*-mer size will start introducing false positives. Second, adjusting the ANI threshold while using a *k*-size of 31, we found that an ANI of 0.995 enables strain-level resolution by distinguishing highly similar but distinct strains. Conversely, at lower ANI thresholds, species differentiation becomes less precise. When using an ANI of 0.90, YACHT may report species that are broadly similar, thus careful interpretation is needed. To mitigate this, we recommend increasing the *k*-size when using a lower ANI threshold to improve specificity.

## Case II: Metagenomic-assembled genome fishing

In the case for metagenomic-assembled genome (MAG) fishing, we can employ YACHT to search or “fish” for a MAG of interest. In the previous case, we used sample SRR32008482 to demonstrate how modifying parameters can influence species reporting. Taking a closer look of that analysis, we observe the detection of *Bacteroidales bacterium* (Accession: GCA\_017506175) in sample SRR32008482 when using a *k*-size of 51 and an ANI threshold of 0.95 at a minimum coverage of 0.5. To elaborate, *B. bacterium* has 2,464 exclusive k-mers, and given our parameters, a minimum of 158 matched *k*-mers were necessary to confidently identify it as present. For sample SRR32008482, there were 1,232 matched *k*-mers, clearly surpassing the threshold requirement to report as present. Expanding on the usage of YACHT, we can perform MAG Fishing—employing a single MAG as the training reference database rather than an extensive database such as GTDB. 

To illustrate MAG fishing using YACHT, we selected a second metagenomic sample, SRR32008483 (also from Bioproject PRJNA1209946), to assess the presence of *B. bacterium* using similar parameters (i.e., *k*-size=51, ANI=0.95, and scale factor=10). When employing a single MAG in YACHT, signatures are generated for every entry found in the FASTA/Q files of the MAG of interest. Therefore, using *B. bacterium* as a MAG reference database, a signature is produced for every scaffold entry, resulting in the detection of *B. bacterium* scaffolds in SRR32008483 at low minimum coverages of 0.1, 0.05, and 0.01. In contrast, for the previous sample SRR32008482, *B. bacterium* scaffolds are  present across a broader range of minimum coverages (1.0, 0.5, 0.1, 0.05, and 0.01). The variation in matched *k*-mers across these different coverage thresholds between samples SRR32008482 and SRR32008483 highlight the critical influence of sequencing coverage. Specifically, SRR32008483 has a notably lower sequencing coverage (6.6 Mb) compared to SRR32008482 (44 Mb), reducing the number of exclusive *k*-mers available to match the MAG of interest. Additionally, comparing scaffolds shared between these samples at varying coverage thresholds, we observe that sample SRR32008482 contains 41 unique scaffolds of *B. bacterium* at a minimum coverage of 0.5 that are not present in sample SRR32008483 at a lower minimum coverage of 0.1. Overall, these observations demonstrate the impact of sequencing depth on MAG fishing.


## Case III: Synthetic metagenomes

Mock or synthetic microbe communities—also known as syncoms—serve as reference standards that are used in metagenomics to benchmark and optimize sequencing-based methods [1,2], as well as evaluating the taxonomic and functional diversity of native microbial communities [3]. YACHT can assess the construction of these synthetic communities to verify the designed microbes are present in the mock community for method evaluation and experimental validation. This can be helpful for identifying organisms missing from (or unexpectedly present) in a synthetic community [4]. 

Previously, we explored how *k*-size and minimum coverage can influence results made by YACHT. Here, we focus on ANI and false positives. Note carefully that we are not comparing at the species level, rather requiring same genome/strain matching for presence and absence. For this use case example, we use an SRA sample (SRR6394747) from the Bioproject PRJNA422917, a mock community called MBARC-26 composed of 26 microbes spanning bacteria and archaea species generated from whole shot-gun sequencing of long reads [2]. Given the prior knowledge of the genomes expected in this syncom, we exclude five microbes, given that they are not found in the reference training database, and evaluate the ability of YACHT to identify the presence of 21 genomes using a *k*-size of 31 and minimum coverage of 0.05 across various ANIs of 0.80, 0.95, and 0.9995. 

At an ANI of 0.95, YACHT identifies 19 expected genomes, with only 8 of those not being reported as present, potentially due to lower sequencing coverages resulting in a reduction of exclusive $k$-mers. When ANI is restricted to 0.9995, YACHT identifies 16 expected genomes barely making a difference when using an ANI of 0.95. On the other hand, if we loosen the constraint of ANI to 0.80, YACHT, as expected, produces many false positives, identifying only 3 of the expected genome. This is due to many reference organisms (distinct from the genomes in the sample) sharing an ANI of 0.80 with those in the sample. As we lower the ANI from 0.80, an increasing number of false positives are reported as present. If we dramatically reduce the ANI, we will observe a substantial uptick in species reported as present, indicating an overly permissive ANI threshold will inflate false positives.  As previously noted in the "Low abundance samples" case, species differentiation becomes less reliable warranting precaution when using low ANIs such as 0.80 as 80% ANI is very lenient of a definition of "same genome". We also examined the effect of increasing the minimum coverage threshold to 0.25 while using an ANI of 0.95. In this case, YACHT reports fewer genomes as present, reducing false positives but also filtering out some true positives—highlighting the tradeoff between sensitivity and specificity at higher coverage thresholds. 


Although we focused on the 21 expected genomes from the synthetic community, this is not a restriction imposed by YACHT, which considers all organisms in the reference database. When we broaden our evaluation to include all genomes reported by YACHT, the patterns remain consistent. At ANI 0.95 and coverage 0.05, YACHT identifies 23 genomes, 22 of which match the sample. At a stricter ANI of 0.9995 with the same coverage, 20 genomes are reported, but only 13 match. At a lenient ANI of 0.80, YACHT detects 74 genomes, with just 3 corresponding to the sample—suggesting the mock community likely comprises a mix of exact strain matches and closely related isolates. Some genomes in the community may not be perfectly represented in the NCBI reference set, but instead belong to the same species as the available reference genomes.

## Citations

[1] Hardwick, S. A., Chen, W. Y., Wong, T., Kanakamedala, B. S., Deveson, I. W., Ongley, S. E., Santini, N. S., Marcellin, E., Smith, M. A., Nielsen, L. K., et al. (2018). Synthetic microbe communities provide internal reference standards for metagenome sequencing and analysis. Nature Communications, 9(1), 3096.

[2] Singer, E., Andreopoulos, B., Bowers, R. M., Lee, J., Deshpande, S., Chiniquy, J., Ciobanu, D., Klenk, H.-P., Zane, M., Daum, C., et al. (2016). Next generation sequencing data of a defined microbial mock community. Scientific Data, 3(1), 1–8.

[3] van Leeuwen, P. T., Brul, S., Zhang, J., & Wortel, M. T. (2023). Synthetic microbial communities (SynComs) of the human gut: design, assembly, and applications. FEMS Microbiology Reviews, 47(2), fuad012.

[4] Tian, S., Kim, M. S., Zhao, J., Heber, K., Hao, F., Koslicki, D., Tian, S., Singh, V., Patterson, A. D., & Bisanz, J. E. (2025). A designed synthetic microbiota provides insight to community function in Clostridioides difficile resistance. Cell Host & Microbe.

